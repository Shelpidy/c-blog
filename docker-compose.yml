services:
    slms_blogpost_api_server_1:
        container_name: slms_blogpost_api_server_container_1
        build: .
        ports:
            - 1111:5000
        environment:
            - PORT=5000
            - MAIL_PORT=${MAIL_PORT}
            - MAIL_HOST=${MAIL_HOST}
            - MAIL_USER=${MAIL_USER}
            - MAIL_PASS=${MAIL_PASS}
            - PG_DB_PASSWORD=${PG_DB_PASSWORD}
            - PG_DB_USERNAME=${PG_DB_USERNAME}
            - PG_DB_HOST=${PG_DB_HOST}
            - PG_DB_NAME=${PG_DB_NAME}
    slms_blogpost_api_server_2:
        container_name: slms_blogpost_api_server_container_2
        build: .
        ports:
            - 2222:5000
        environment:
            - PORT=5000
              - MAIL_PORT=${MAIL_PORT}
              - MAIL_HOST=${MAIL_HOST}
              - MAIL_USER=${MAIL_USER}
              - MAIL_PASS=${MAIL_PASS}
              - PG_DB_PASSWORD=${PG_DB_PASSWORD}
              - PG_DB_USERNAME=${PG_DB_USERNAME}
              - PG_DB_HOST=${PG_DB_HOST}
              - PG_DB_NAME=${PG_DB_NAME}
    slms_blogpost_api_server_3:
        container_name: slms_blogpost_api_server_container_3
        build: .
        ports:
            - 3333:5000
        environment:
            - PORT=5000
              - MAIL_PORT=${MAIL_PORT}
              - MAIL_HOST=${MAIL_HOST}
              - MAIL_USER=${MAIL_USER}
              - MAIL_PASS=${MAIL_PASS}
              - PG_DB_PASSWORD=${PG_DB_PASSWORD}
              - PG_DB_USERNAME=${PG_DB_USERNAME}
              - PG_DB_HOST=${PG_DB_HOST}
              - PG_DB_NAME=${PG_DB_NAME}
    nginx:
        container_name: nginx_container
        build:
            context: ./nginx/
            dockerfile: Dockerfile
        ports:
            - 5000:80
        depends_on:
            - slms_blogpost_api_server_1
            - slms_blogpost_api_server_2
            - slms_blogpost_api_server_3
